<!doctype html>
<html lang="zh-Hans">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Yoyi çš„å‹å²é’±å°è´¦æœ¬</title>

<style>
:root{
  --bg:#f6f7fb;
  --card:#fff;
  --line:#e5e7eb;
  --text:#111827;
  --muted:#6b7280;
  --good:#16a34a;
  --bad:#dc2626;
}
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
  background:var(--bg);
  color:var(--text);
}
header{padding:18px;font-weight:900;font-size:22px}
.card{
  background:#fff;border-radius:18px;margin:12px;padding:16px;
  box-shadow:0 8px 20px rgba(0,0,0,.07);
}
input,select{
  width:100%;padding:12px;margin-top:6px;
  border:1px solid var(--line);border-radius:12px;font-size:16px;
}
button{
  border:0;border-radius:12px;padding:12px 16px;
  font-size:15px;margin-top:10px;cursor:pointer;
}
.primary{background:#111;color:#fff}
.secondary{background:#fff;border:1px solid var(--line)}
.danger{border:1px solid #fecaca;color:var(--bad);background:#fff}

table{min-width:720px;width:100%;border-collapse:collapse}
th,td{padding:14px;border-bottom:1px solid var(--line);font-size:14px}
th:nth-child(4),td:nth-child(4){padding-right:30px}
th:nth-child(5),td:nth-child(5){padding-left:30px}
.right{text-align:right}
.good{color:var(--good);font-weight:700}
.bad{color:var(--bad);font-weight:700}
</style>
</head>

<body>

<header>ğŸ§¸ Yoyi çš„å‹å²é’±å°è´¦æœ¬</header>

<div class="card">
<b>ğŸ’° Saveï¼š</b><span id="save">0</span>Â¥<br>
<b>ğŸ Wishï¼š</b><span id="wish">0</span>Â¥<br>
<b>â¤ï¸ Giveï¼š</b><span id="give">0</span>Â¥
</div>

<div class="card">
<h3>æ·»åŠ è®°å½•</h3>
<select id="acct">
<option value="save">Save</option>
<option value="wish">Wish</option>
<option value="give">Give</option>
</select>

<select id="type">
<option value="in">å­˜å…¥</option>
<option value="out">æ”¯å‡º</option>
</select>

<input id="amt" placeholder="é‡‘é¢">
<input id="note" placeholder="å¤‡æ³¨">

<button class="primary" onclick="add()">ä¿å­˜</button>
<button class="secondary" onclick="exportCSV()">å¯¼å‡ºCSV</button>
<button class="danger" onclick="reset()">æ¸…ç©ºæ•°æ®</button>
</div>

<div class="card">
<h3>è®°å½•åˆ—è¡¨</h3>
<div style="overflow:auto">
<table>
<thead>
<tr>
<th>æ—¥æœŸ</th>
<th>è´¦æˆ·</th>
<th>ç±»å‹</th>
<th class="right">é‡‘é¢</th>
<th>å¤‡æ³¨</th>
<th></th>
</tr>
</thead>
<tbody id="list"></tbody>
</table>
</div>
</div>

<script>
const KEY="yoyi_money";
function load(){return JSON.parse(localStorage.getItem(KEY)||"[]")}
function save(d){localStorage.setItem(KEY,JSON.stringify(d))}
function yen(n){return Number(n).toLocaleString()}

function render(){
 const data=load()
 let bal={save:0,wish:0,give:0}
 data.forEach(t=>bal[t.acct]+=t.type=="in"?t.amt:-t.amt)
 save.textContent=yen(bal.save)
 wish.textContent=yen(bal.wish)
 give.textContent=yen(bal.give)

 list.innerHTML=""
 data.slice().reverse().forEach((t,i)=>{
 list.innerHTML+=`
<tr>
<td>${t.date}</td>
<td>${t.acct}</td>
<td>${t.type=="in"?"å­˜å…¥":"æ”¯å‡º"}</td>
<td class="right ${t.type=="in"?"good":"bad"}">${t.type=="in"?"+":"-"}${yen(t.amt)}</td>
<td>${t.note||""}</td>
<td><button onclick="del(${data.length-1-i})">åˆ é™¤</button></td>
</tr>`
 })
}

function add(){
 let data=load()
 data.push({
 date:new Date().toLocaleDateString(),
 acct:acct.value,
 type:type.value,
 amt:Number(amt.value),
 note:note.value
 })
 save(data)
 amt.value="";note.value=""
 render()
}

function del(i){
 let data=load()
 data.splice(i,1)
 save(data)
 render()
}

function exportCSV(){
 let data=load()
 let csv="date,account,type,amount,note\n"
 data.forEach(t=>csv+=`${t.date},${t.acct},${t.type},${t.amt},${t.note}\n`)
 let a=document.createElement("a")
 a.href=URL.createObjectURL(new Blob([csv]))
 a.download="money.csv";a.click()
}

function reset(){localStorage.removeItem(KEY);render()}
render()
</script>

</body>
</html>
